# 标准版安装指南

## 安装顺序

`安装过程中请严格遵守以下安装顺序，并确保每一过程都按要求完成后再继续。`

1. ERP环境检查

2. ERP服务器端补丁更新

3. ERP服务器端1P插件安装

4. MES服务器环境检查

5. ERP服务器或MES服务器环境检查有异常，请务必先修复，然后再继续下一步

6. MES服务器端安装


## 安装环境要求

### 硬件环境要求

> 基本准则
1. 独立部署，MES服务器内存必须大于16G;有效内存不低于8G;
2. 集中部署，MES服务器内存必须大于32G;有效内存不低于12G;

> 推荐配置

| 项目        | 要求   |  说明  |
| --------   | :-----  | :----:  |
| 处理器（CPU）      | 四核以上，主频2.66G以上   |   -     |
| 内存（RAM）        |   64GB以上   |   -   |
| 硬盘（HD）        |   5\*1T以上，RAID5+热备（SAS HD，10Krpm或以上）    |  -  |

```
注意事项：
-   推荐配置磁盘阵列，至少4张10K转/分的硬盘以上制作Raid0+1或RAID5+热备。
-   建议服务器内存增加到64G，现硬件发展十分迅速，上述处理器是最低配置建议。
-   使用最低配置不保证运行效率，但正常运行系统没有问题。
-   数据库服务器硬盘空间要大，建议容量2TB以上，有数据保护机制，数据库分区1.5TB以上。
-   必须使用原版安装操作系统，不能使用被修改过的Ghost 版本。

```

### 软件环境要求

> 服务器操作系统要求

服务器支持：

- Windows Server 2008 R2 X64（SP1以上）
- Windows Server2012 R2 Standard X64
- Windows 7旗舰版 X64
- Windows 10专业版 X64

> 服务器数据库及其版本要求

- SQL Server 2012及以上版本
- `**SQL Server 2008不支持`

### ERP环境要求

- 用友软件U8+的版本要求

> U8+必要补丁安装

  ```
  推荐安装U8版本为U8+V13.0，并打了文件名尾部为"-FS"、"-ST"、"InterfaceChangeFiles"的补丁文件：
  ```

  - KB-U8V13.0-XXXXXX-XXXXXX-InterfaceChangeFiles.msi
  - CP-U8V13.0-XXXXX-XXXXXX-FS.msi
  - CP-U8V13.0-XXXXX-XXXXXX-ST.msi

- 其它ERP软件要求

  _待续_

### 客户端要求

- 客户端必须是中文版本的WIN7(打SP1补丁)、WIN8、Windows server
2008、Windows Server 2012、WIN10
- 安装谷歌Chrome浏览器，浏览器的版本为56以上。
- `WinXP不支持`

## 安装注意事项

> ERP服务器注意事项

- 安装U8插件：必须要先安装Framework4.6.1程序
- 安装U8插件：请确认服务器计算机已经安装了
- 安装过程中需要使用`ERP账套管理员`账号和密码，请确认正确可用
- 安装过程中需要使用`数据库管理员`账号和密码，请确认正确可用

> MES服务器注意事项

- 安装MES：建议操作系统Server 2012中文X64位及以上版本。
- 安装MES：请确认安装 X64位 SQL Server2012或以上版本。建议数据库系统为:SQL Server 2012中文X64位企业版。
- 安装MES：如果操作系统为windows server 2008,则需要执行安装盘plugins目录下的vcredist\_x64.exe文件。
- 安装MES：MES应用服务器必须要先安装Framework2.6程序。
- 安装MES：必须在服务器电脑上安装google浏览器。
- 安装过程中需要使用`数据库管理员`账号和密码，请确认正确可用

> 应用客户终端注意事项

- ERP服务器未按`U8+必要补丁安装`要求，客户端将无法正常访问，
- Windows自带防护墙已关闭（如果打开防火墙，请将U8服务的13391端口设置为允许访问），并已启用IIS中的ASP服务
- 有关防护墙和端口设置请联络本企业IT管理员

## 安装前检查

1. 确保SQL SERVER服务器的TCP/IP协议启用。
  TCP/IP启用的详情设置如下：
  [图片]()

2. 集中部署时，请确保MES数据库必须要与U8的数据库在同一个实例下；

3. MES安装目录所在的磁盘的最少可用空间必须大于5G的磁盘空间，在真实运行时请尽量为其分配大于100GB空间，因为在程序运行时会产生日志，这些日志文件会随着程序运行的时间增长而增大;

4. MES安装的可用内存必须大于5G。MES在WINDOWS运行需要至少5GB可用内存，可用内存不是指硬件安装的内存容量，而是指当前系统中可用的内存余额

`例如：安装的内存为8GB，在安装R9时，系统中已用内存 26%,约2.1GB，可用的内存余额只有5.9G。将发生运行时错误。`

5. 服务器可能会误杀安装文件，请确保防火墙已关闭或信任所有安装文件。

## 服务器端安装

1.  运行HY-U8V13.0-38801-xxxxxx-1P.msi文件，自动弹出安装欢迎界面。如想取消安装可以选择"取消"操作；选择"下一步"继续安装程序。

![图片](media/image5.png)

2.  确认许可协议

![图片](media/image6.png)

3.  确认安装

![图片](media/image7.png)

4.  选择要与MES建立接口的账套，执行脚本。

1）、按任意键继续。

![图片](media/image8.png)

2）、执行数据库操作。

 ![图片](media/image9.png)
 ![图片](media/image10.png)

```
说明：

1.  录入数据库服务器的电脑名或IP地址，本地用localhost也可以，对应操作"1"；

2.  录入数据库的用户名和密码，对应操作"2"；

3.  单击"测试连接"，查看能否连接数据库服务器，对应操作"3"；

4.  选择要与MES建立接口的U8账套，不关联的不选择，对应操作"4"；

5.  单击"开始执行"，执行数据脚本，对应操作"5"；

6.  单击"取消"，退出安装。

```

5. 数据库操作完成。

![图片](media/image11.png)

6.  服务器插件安装完成。

![图片](media/image12.png)

7.  启用MES模块。

![图片](media/image13.png)

```
说明：

1）、单击"基础设置"，对应操作"1"；

2）、单击"基本信息"，对应操作"2"；

3）、单击"系统启用"，对应操作"3"；

4）、单击"生产MES插件"选择启用机械行业MES插件，

对应操作"4"。
```

8.  安装成功并且在模块启用中启用了"机械行业MES"后，在U8中呈现如下结果。

1)、菜单中增加"生产制造/生产MES插件"

![图片](media/image14.png)

> 2）、单击"选项"，弹出窗口，用来设置MES与U8的接口地址和MES打开地址。

![图片](media/image15.png)

```
说明：

1）、U8API地址格式：http:// XXX.XXX.X.XXX:13391

2）、MES地址格式：<http://XXX.XXX.X.XXX:8080>

3）、保存。

注意：端口13391或8080一般不会被占用，若被占用，则在IIS服务器中重新设置这2个用用的端口，确认能访问后，再将正确，没有被占用的端口手工填些在这个界面。

3）、单击"访问MES"，用来打开MES应用程序。
```


### 独立部署安装


### 集中部署安装

基本步骤，请参照`标准版本，独立部署时，MES服务器端安装`


## 应用终端安装

谷歌浏览器安装，相关操作如有疑问请联络您所在公司的IT管理员。

## 异常问题处理
